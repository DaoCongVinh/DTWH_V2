#1 [internal] load local bake definitions
#1 reading from stdin 989B done
#1 DONE 0.0s

#2 [crawler internal] load build definition from Dockerfile
#2 transferring dockerfile: 365B done
#2 DONE 0.0s

#3 [loader-staging internal] load build definition from Dockerfile
#3 transferring dockerfile: 381B 0.0s done
#3 DONE 0.0s

#4 [loader-staging internal] load metadata for docker.io/library/python:3.12-slim
#4 DONE 0.9s

#5 [crawler internal] load .dockerignore
#5 transferring context: 2B done
#5 DONE 0.0s

#6 [loader-staging internal] load .dockerignore
#6 transferring context: 2B done
#6 DONE 0.0s

#7 [crawler internal] load build context
#7 transferring context: 285B done
#7 DONE 0.0s

#8 [loader-staging internal] load build context
#8 transferring context: 11.69kB done
#8 DONE 0.0s

#9 [crawler 1/5] FROM docker.io/library/python:3.12-slim@sha256:b43ff04d5df04ad5cabb80890b7ef74e8410e3395b19af970dcd52d7a4bff921
#9 resolve docker.io/library/python:3.12-slim@sha256:b43ff04d5df04ad5cabb80890b7ef74e8410e3395b19af970dcd52d7a4bff921 0.0s done
#9 DONE 0.0s

#10 [crawler 4/5] RUN apt-get update && apt-get install -y build-essential libssl-dev &&     pip install --no-cache-dir -r requirements.txt &&     pip install cryptography &&     apt-get clean && rm -rf /var/lib/apt/lists/*
#10 CACHED

#11 [crawler 3/5] COPY requirements.txt .
#11 CACHED

#12 [crawler 2/5] WORKDIR /app
#12 CACHED

#13 [loader-staging 3/5] COPY requirements.txt .
#13 CACHED

#14 [crawler 5/5] COPY . .
#14 CACHED

#15 [loader-staging 4/5] RUN apt-get update && apt-get install -y build-essential libssl-dev     && pip install --no-cache-dir -r requirements.txt     && apt-get clean && rm -rf /var/lib/apt/lists/*
#15 CACHED

#16 [loader-staging 5/5] COPY loader_v2.py loader_simple.sql date_dim.csv ./
#16 DONE 0.1s

#17 [loader-staging] exporting to image
#17 ...

#18 [crawler] exporting to image
#18 exporting layers done
#18 exporting manifest sha256:973a1f9bfd7818cb2a69386eadd934dd139e5b723eb4696d4df103056f6d01f8 done
#18 exporting config sha256:968e3945880fa23c779c6588988449dbdb5266a3f3fb4557496dcdd8c3791f18 done
#18 exporting attestation manifest sha256:e5515d7508166fec314da6467982537d0acd8afe6c3c30ae20cb5b128b881b89 0.0s done
#18 exporting manifest list sha256:c146e393377be9c62f5dffd05f72ed5a6ebed243a04db12ed44ef2aa18450e47 0.0s done
#18 naming to docker.io/library/dtwh_v2-crawler:latest done
#18 unpacking to docker.io/library/dtwh_v2-crawler:latest done
#18 DONE 0.1s

#17 [loader-staging] exporting to image
#17 exporting layers 0.1s done
#17 ...

#19 [crawler] resolving provenance for metadata file
#19 DONE 0.0s

#17 [loader-staging] exporting to image
#17 exporting manifest sha256:54962f88e5a92bb1fc5821e5e690c751eb20e3527b2506d0c79697e687a79b21 0.0s done
#17 exporting config sha256:c4d7b89e5dbe90abe7fcbf9ed7ed36e83a01704b8796b5c75e369b31a4879654 0.0s done
#17 exporting attestation manifest sha256:0ccc69e0940e25bf32293200f5b9fc59b9b0f42f95ae8f7532c663783f39ac9f 0.0s done
#17 exporting manifest list sha256:d703af94332a6617c0f2a50776085df4e7298a5e4658076137170ccd936cbaa1 0.0s done
#17 naming to docker.io/library/dtwh_v2-loader-staging:latest done
#17 unpacking to docker.io/library/dtwh_v2-loader-staging:latest 0.0s done
#17 DONE 0.2s

#20 [loader-staging] resolving provenance for metadata file
#20 DONE 0.0s
 dtwh_v2-loader-staging  Built
 dtwh_v2-crawler  Built
 Network dtwh_v2_tiktok_network  Creating
 Network dtwh_v2_tiktok_network  Created
 Volume "dtwh_v2_db_data"  Creating
 Volume "dtwh_v2_db_data"  Created
 Container dtwh_v2-db-1  Creating
 Container dtwh_v2-db-1  Created
 Container dtwh_v2-crawler-1  Creating
 Container dtwh_v2-loader-staging-1  Creating
 Container dtwh_v2-loader-staging-1  Created
 Container dtwh_v2-crawler-1  Created
Attaching to crawler-1, db-1, loader-staging-1
db-1  | 2025-11-21 16:56:09+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 8.0.44-1.el9 started.
db-1  | 2025-11-21 16:56:09+00:00 [Note] [Entrypoint]: Switching to dedicated user 'mysql'
db-1  | 2025-11-21 16:56:09+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 8.0.44-1.el9 started.
db-1  | 2025-11-21 16:56:09+00:00 [Note] [Entrypoint]: Initializing database files
db-1  | 2025-11-21T16:56:09.573211Z 0 [Warning] [MY-011068] [Server] The syntax '--skip-host-cache' is deprecated and will be removed in a future release. Please use SET GLOBAL host_cache_size=0 instead.
db-1  | 2025-11-21T16:56:09.573290Z 0 [System] [MY-013169] [Server] /usr/sbin/mysqld (mysqld 8.0.44) initializing of server in progress as process 80
db-1  | 2025-11-21T16:56:09.578833Z 1 [System] [MY-013576] [InnoDB] InnoDB initialization has started.
db-1  | 2025-11-21T16:56:10.056792Z 1 [System] [MY-013577] [InnoDB] InnoDB initialization has ended.
db-1  | 2025-11-21T16:56:11.160527Z 6 [Warning] [MY-010453] [Server] root@localhost is created with an empty password ! Please consider switching off the --initialize-insecure option.
db-1  | 2025-11-21 16:56:14+00:00 [Note] [Entrypoint]: Database files initialized
db-1  | 2025-11-21 16:56:14+00:00 [Note] [Entrypoint]: Starting temporary server
db-1  | 2025-11-21T16:56:14.906759Z 0 [Warning] [MY-011068] [Server] The syntax '--skip-host-cache' is deprecated and will be removed in a future release. Please use SET GLOBAL host_cache_size=0 instead.
db-1  | 2025-11-21T16:56:14.908605Z 0 [System] [MY-010116] [Server] /usr/sbin/mysqld (mysqld 8.0.44) starting as process 124
db-1  | 2025-11-21T16:56:14.923014Z 1 [System] [MY-013576] [InnoDB] InnoDB initialization has started.
db-1  | 2025-11-21T16:56:15.116118Z 1 [System] [MY-013577] [InnoDB] InnoDB initialization has ended.
db-1  | 2025-11-21T16:56:15.357767Z 0 [Warning] [MY-010068] [Server] CA certificate ca.pem is self signed.
db-1  | 2025-11-21T16:56:15.357815Z 0 [System] [MY-013602] [Server] Channel mysql_main configured to support TLS. Encrypted connections are now supported for this channel.
db-1  | 2025-11-21T16:56:15.360543Z 0 [Warning] [MY-011810] [Server] Insecure configuration for --pid-file: Location '/var/run/mysqld' in the path is accessible to all OS users. Consider choosing a different directory.
db-1  | 2025-11-21T16:56:15.374739Z 0 [System] [MY-011323] [Server] X Plugin ready for connections. Socket: /var/run/mysqld/mysqlx.sock
db-1  | 2025-11-21T16:56:15.374855Z 0 [System] [MY-010931] [Server] /usr/sbin/mysqld: ready for connections. Version: '8.0.44'  socket: '/var/run/mysqld/mysqld.sock'  port: 0  MySQL Community Server - GPL.
db-1  | 2025-11-21 16:56:15+00:00 [Note] [Entrypoint]: Temporary server started.
db-1  | '/var/lib/mysql/mysql.sock' -> '/var/run/mysqld/mysqld.sock'
db-1  | Warning: Unable to load '/usr/share/zoneinfo/iso3166.tab' as time zone. Skipping it.
db-1  | Warning: Unable to load '/usr/share/zoneinfo/leap-seconds.list' as time zone. Skipping it.
db-1  | Warning: Unable to load '/usr/share/zoneinfo/leapseconds' as time zone. Skipping it.
db-1  | Warning: Unable to load '/usr/share/zoneinfo/tzdata.zi' as time zone. Skipping it.
db-1  | Warning: Unable to load '/usr/share/zoneinfo/zone.tab' as time zone. Skipping it.
db-1  | Warning: Unable to load '/usr/share/zoneinfo/zone1970.tab' as time zone. Skipping it.
db-1  | 2025-11-21 16:56:17+00:00 [Note] [Entrypoint]: Creating database dwh_tiktok
db-1  | 2025-11-21 16:56:17+00:00 [Note] [Entrypoint]: Creating user user
db-1  | 2025-11-21 16:56:17+00:00 [Note] [Entrypoint]: Giving user user access to schema dwh_tiktok
db-1  | 
db-1  | 2025-11-21 16:56:17+00:00 [Note] [Entrypoint]: /usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/01_create_requested_user.sql
db-1  | 
db-1  | 
db-1  | 2025-11-21 16:56:17+00:00 [Note] [Entrypoint]: /usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/02_create_dbstaging_tables.sql
db-1  | 
db-1  | 
db-1  | 2025-11-21 16:56:17+00:00 [Note] [Entrypoint]: /usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/schema.sql
db-1  | 2025-11-21T16:56:17.382182Z 15 [Warning] [MY-010235] [Server] Following users were specified in CREATE USER IF NOT EXISTS but they already exist. Corresponding entry in binary log used default authentication plugin 'caching_sha2_password' to rewrite authentication information (if any) for them: 'user'@'%'
db-1  | 
db-1  | 
db-1  | 2025-11-21 16:56:17+00:00 [Note] [Entrypoint]: Stopping temporary server
db-1  | 2025-11-21T16:56:17.749912Z 16 [System] [MY-013172] [Server] Received SHUTDOWN from user root. Shutting down mysqld (Version: 8.0.44).
db-1  | 2025-11-21T16:56:19.329890Z 0 [System] [MY-010910] [Server] /usr/sbin/mysqld: Shutdown complete (mysqld 8.0.44)  MySQL Community Server - GPL.
db-1  | 2025-11-21 16:56:19+00:00 [Note] [Entrypoint]: Temporary server stopped
db-1  | 
db-1  | 2025-11-21 16:56:19+00:00 [Note] [Entrypoint]: MySQL init process done. Ready for start up.
db-1  | 
db-1  | 2025-11-21T16:56:19.961537Z 0 [Warning] [MY-011068] [Server] The syntax '--skip-host-cache' is deprecated and will be removed in a future release. Please use SET GLOBAL host_cache_size=0 instead.
db-1  | 2025-11-21T16:56:19.962606Z 0 [System] [MY-010116] [Server] /usr/sbin/mysqld (mysqld 8.0.44) starting as process 1
db-1  | 2025-11-21T16:56:19.969149Z 1 [System] [MY-013576] [InnoDB] InnoDB initialization has started.
db-1  | 2025-11-21T16:56:20.158506Z 1 [System] [MY-013577] [InnoDB] InnoDB initialization has ended.
db-1  | 2025-11-21T16:56:20.331330Z 0 [Warning] [MY-010068] [Server] CA certificate ca.pem is self signed.
db-1  | 2025-11-21T16:56:20.331365Z 0 [System] [MY-013602] [Server] Channel mysql_main configured to support TLS. Encrypted connections are now supported for this channel.
db-1  | 2025-11-21T16:56:20.333847Z 0 [Warning] [MY-011810] [Server] Insecure configuration for --pid-file: Location '/var/run/mysqld' in the path is accessible to all OS users. Consider choosing a different directory.
db-1  | 2025-11-21T16:56:20.348333Z 0 [System] [MY-011323] [Server] X Plugin ready for connections. Bind-address: '::' port: 33060, socket: /var/run/mysqld/mysqlx.sock
db-1  | 2025-11-21T16:56:20.348537Z 0 [System] [MY-010931] [Server] /usr/sbin/mysqld: ready for connections. Version: '8.0.44'  socket: '/var/run/mysqld/mysqld.sock'  port: 3306  MySQL Community Server - GPL.
crawler-1  | 2025-11-21 16:56:30,394 - INFO - Scheduler disabled or no cron expression; running once.
crawler-1  | 2025-11-21 16:56:30,394 - INFO - Job started for device device-unknown
crawler-1  | 2025-11-21 16:56:30,405 - INFO - Calling Apify actor: GdWCkxBtKWOsKjdch
loader-staging-1  | Creating schema...
loader-staging-1  | Î“Â£Ã  Schema ready.
loader-staging-1  | Loading DateDim...
loader-staging-1  | Î“Â£Ã  Loaded DateDim from /app/date_dim.csv
loader-staging-1  | Found 8 JSON files to process.
loader-staging-1  | Processing device-unknown_run_12112025T102337Z.json...
loader-staging-1  | Î“Â£Ã  device-unknown_run_12112025T102337Z.json: 3 records processed
loader-staging-1  | Processing device-unknown_run_12112025T102605Z.json...
loader-staging-1  | Î“Â£Ã  device-unknown_run_12112025T102605Z.json: 3 records processed
loader-staging-1  | Processing device-unknown_run_20112025T131655Z.json...
loader-staging-1  | Î“Â£Ã  device-unknown_run_20112025T131655Z.json: 3 records processed
loader-staging-1  | Processing device-unknown_run_20112025T134408Z.json...
loader-staging-1  | Î“Â£Ã  device-unknown_run_20112025T134408Z.json: 3 records processed
loader-staging-1  | Processing device-unknown_run_21112025T165111Z.json...
loader-staging-1  | Î“Â£Ã  device-unknown_run_21112025T165111Z.json: 3 records processed
loader-staging-1  | Processing device-unknown_run_21112025T165324Z.json...
loader-staging-1  | Î“Â£Ã  device-unknown_run_21112025T165324Z.json: 3 records processed
loader-staging-1  | Processing device-unknown_run_21112025T165424Z.json...
loader-staging-1  | Î“Â£Ã  device-unknown_run_21112025T165424Z.json: 3 records processed
loader-staging-1  | Processing device-unknown_run_30102025T023930Z.json...
loader-staging-1  | Î“Â£Ã  device-unknown_run_30102025T023930Z.json: 100 records processed
loader-staging-1  | Î“Â£Ã  Pipeline completed successfully!

[Kloader-staging-1 exited with code 0
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> Status: RUNNING, Message: 
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:31.729Z ACTOR: Pulling container image of build tSYT1F9Ve8ZomN7ZM from registry.
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:31.731Z ACTOR: Creating container.
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:31.784Z ACTOR: Starting container.
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:31.975Z Will run command: xvfb-run -a -s "-ac -screen 0 1920x1080x24+32 -nolisten tcp" /bin/sh -c ./start_xvfb_and_run_cmd.sh && npm run start:prod --silent
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:33.165Z INFO  System info {"apifyVersion":"3.4.2","apifyClientVersion":"2.12.6","crawleeVersion":"3.13.9","osType":"Linux","nodeVersion":"v20.19.5"}
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> Status: RUNNING, Message: Starting the crawler.
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:34.157Z INFO  CheerioCrawler: Starting the crawler.
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:36.243Z WARN  CheerioCrawler: Reclaiming failed request back to the list or queue. Failed to parse TikTok response: Unexpected end of JSON input --- https://www.tiktok.com/tag/fyp
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:36.244Z     at makeWebApiCall (file:///home/myuser/dist/src/tools/api/web/make-web-api-call.js:107:54) {"id":"jsSJF5lHnpb4Nir","url":"https://www.tiktok.com/tag/fyp","retryCount":1}
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:39.036Z INFO  [HASHTAG_CONTINUATION] Scraped 30 videos --- https://www.tiktok.com/tag/fyp
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:39.789Z INFO  [HASHTAG_CONTINUATION] Scraped 27 videos --- https://www.tiktok.com/tag/fyp
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:42.629Z INFO  [HASHTAG_CONTINUATION] Scraped 30 videos --- https://www.tiktok.com/tag/fyp
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:42.630Z INFO  [HASHTAG_CONTINUATION] No more videos to scrape. --- https://www.tiktok.com/tag/fyp
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:44.029Z INFO  [Status message]: Scraped 1/1 hashtags
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:44.799Z INFO  [HASHTAG_CONTINUATION] Scraped 27 videos --- https://www.tiktok.com/tag/fyp
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> Status: RUNNING, Message: Crawled 5/6 pages, 0 failed requests, desired concurrency 10.
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:44.869Z INFO  CheerioCrawler: All requests from the queue have been processed, the crawler will shut down.
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:45.156Z INFO  CheerioCrawler: Final request statistics: {"requestsFinished":6,"requestsFailed":0,"retryHistogram":[5,1],"requestAvgFailedDurationMillis":null,"requestAvgFinishedDurationMillis":4578,"requestsFinishedPerMinute":32,"requestsFailedPerMinute":0,"requestTotalDurationMillis":27467,"requestsTotal":6,"crawlerRuntimeMillis":11189}
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:45.157Z INFO  CheerioCrawler: Finished! Total 6 requests: 6 succeeded, 0 failed. {"terminal":true}
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:45.180Z INFO  [Status message]: Scraped 1/1 hashtags
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> 2025-11-21T16:56:45.341Z INFO  [Status message]: Scraped 1/1 hashtags
crawler-1         | [apify.tiktok-scraper runId:L4EAkbJPz8yrSwRP7] -> Status: SUCCEEDED, Message: Scraped 1/1 hashtags
crawler-1         | 2025-11-21 16:56:51,749 - INFO - Fetching results from dataset: RTyTfQ7exm52vFvwX
crawler-1         | 2025-11-21 16:56:52,078 - WARNING - Email config missing. Skipping email notification.
crawler-1         | 2025-11-21 16:56:52,078 - INFO - Job finished successfully.

[Kcrawler-1 exited with code 0
